define(["exports"],function(t){"use strict";function e(t){if(Array.isArray(t))return t.slice();if(Object.assign)return Object.assign({},t);var e={};for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function o(t){return Object.freeze?Object.freeze(t):t}function s(t,s,n,l,r){var c=t.prototype[s];l=l||i,t.prototype[s]=function(){var t,s,i,h,u=a.indexOf(this)<0&&(!r||r.apply(this,arguments));if(u)for(a.push(this),t=0,s=n.length;s>t;t++)this[n[t]]=e(this[n[t]]);try{i=c.apply(this,arguments)}catch(b){h=b}if(u){if(l.freeze)for(t=0,s=n.length;s>t;t++)this[n[t]]=o(this[n[t]]);a.splice(a.indexOf(this),1)}if(h)throw h;return i}}function n(t,e,o,s,n,i){var a,l,r=!1;if(e[o])if(e[o]&&!s)r=!0;else if(e[o]._type!==n)r=!0;else for(a in i)l=i[a],r=r||e[o][l]!==s[l];else r=null!=s;if(r)if(s){t[o]={_type:n};for(a in i)l=i[a],t[o][l]=s[l]}else t[o]=null;else t[o]=e[o];return r}var i={freeze:!0},a=[];t.infectModelClass=function(t,e){if(!t.prototype.idAttribute)throw new Error("Backbone Model Class expected");s(t,"set",["attributes"],e),t.prototype._immutableBackboneModel=!0},t.infectCollectionClass=function(t,e){if(!t.prototype.set)throw new Error("Backbone Collection Class expected");if(t.prototype.model&&!t.prototype.model.prototype._immutableBackboneModel)throw new Error("Cannot make a collection immutable unless it's models are immutable");s(t,"set",["models"],e),s(t,"sort",["models"],e),s(t,"_removeModels",["models"],e),s(t,"_onModelEvent",["models"],e,function(t){return"change"===t}),t.prototype._immutableBackboneCollection=!0},t.infect=function(e,o){if(e.Model&&e.Collection)return t.infectModelClass(e.Model,o),void t.infectCollectionClass(e.Collection,o);if(!e.prototype.set){var s="";throw e.set&&(s=", not an instance"),new Error("infect must be called on a Backbone Model/Collection class"+s)}e.prototype.idAttribute?t.infectModelClass(e,o):t.infectCollectionClass(e,o)},t.PureRenderMixin={componentDidMount:function(){this._immutableBackbonePropsStash=this.stashBackbone({},{},this.props).stash,this._immutableBackboneStateStash=this.stashBackbone({},{},this.state).stash},componentWillUpdate:function(t,e){this._immutableBackbonePropsStash=this.stashBackbone(this._immutableBackbonePropsStash,this.props,t).stash,this._immutableBackboneStateStash=this.stashBackbone(this._immutableBackboneStateStash,this.state,e).stash},componentWillUnmount:function(){delete this._immutableBackbonePropsStash,delete this._immutableBackboneStateStash},shouldComponentUpdate:function(t,e){var o=this.stashBackbone(this._immutableBackbonePropsStash,this.props,t).changed||this.stashBackbone(this._immutableBackboneStateStash,this.state,e).changed;return o},stashBackbone:function(t,e,o){var s,i,a=!1,l={};e=e||{},o=o||{};var r=Object.keys(o),c=Object.keys(e);a||(a=r.length!==c.length);for(s in o){a||(a=-1===c.indexOf(s)),a||(a=e[s]!==o[s]),i=o[s];var h=i&&i._immutableBackboneModel,u=i&&i._immutableBackboneCollection,b=t[s]&&"model"===t[s]._type,f=t[s]&&"collection"===t[s]._type;h||!u&&b?a=n(l,t,s,i,"model",["attributes"])||a:(u||f)&&(a=n(l,t,s,i,"collection",["models"])||a)}return{changed:a,stash:l}}}});